(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{55:function(a,t,s){"use strict";s.r(t);var r=s(0),e=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"持续集成-覆盖率测试-travis-ci和overalls使用心得"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#持续集成-覆盖率测试-travis-ci和overalls使用心得","aria-hidden":"true"}},[a._v("#")]),a._v(" 持续集成+覆盖率测试 Travis CI和Overalls使用心得")]),s("h2",{attrs:{id:"什么是travis-ci"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是travis-ci","aria-hidden":"true"}},[a._v("#")]),a._v(" 什么是Travis CI")]),s("blockquote",[s("p",[a._v("Travis CI是在软件开发领域中的一个在线的，分布式的持续集成服务，用来构建及测试在GitHub托管的代码。这个软件的代码同时也是开源的，可以在GitHub上下载到，尽管开发者当前并不推荐在闭源项目中单独使用它。")])]),s("p",[a._v("Travis CI可以设置github托管的项目在push或者pull等时机触发构建与测试，进行持续集成，简单说，是一个基于Github的免费持续集成服务。")]),s("h2",{attrs:{id:"如何使用travis-ci"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何使用travis-ci","aria-hidden":"true"}},[a._v("#")]),a._v(" 如何使用Travis CI")]),s("ul",[s("li",[a._v("1.登陆Travis CI官网，使用github授权登录，"),s("a",{attrs:{href:"https://travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网地址")])])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/3-pic-1467773139613.jpg",alt:"pic"}})]),s("ul",[s("li",[a._v("2.添加持续集成的项目，如下图所示，点击+号添加需要持续集成的项目。")])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/4-pic_hd-1467773781180.jpg",alt:"pic"}})]),s("ul",[s("li",[a._v("3.继续操作，选择需要持续集成的项目，点击齿轮进行详细配置。")])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/5-pic_hd-1467774145213.jpg",alt:"pic"}})]),s("ul",[s("li",[a._v("4.配置持续集成的条件，一般选择红线部分开启即可。")])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/6-pic_hd-1467774254393.jpg",alt:"pic"}})]),s("h2",{attrs:{id:"配置-travis-yml文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-travis-yml文件","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置.travis.yml文件")]),s("p",[a._v("在你的项目中建立.travis.yml文件，这是一种yaml语言的配置文件，基本格式如下：")]),s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{attrs:{class:"token key atrule"}},[a._v("branches")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{attrs:{class:"token key atrule"}},[a._v("only")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" master\n"),s("span",{attrs:{class:"token key atrule"}},[a._v("language")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" node_js\n"),s("span",{attrs:{class:"token key atrule"}},[a._v("node_js")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{attrs:{class:"token string"}},[a._v("'4.2.2'")]),a._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{attrs:{class:"token string"}},[a._v("'6.0.0'")]),a._v("\n"),s("span",{attrs:{class:"token key atrule"}},[a._v("script")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" make test"),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v("all\n"),s("span",{attrs:{class:"token key atrule"}},[a._v("after_success")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cat ./coverage/lcov.info "),s("span",{attrs:{class:"token punctuation"}},[a._v("|")]),a._v(" ./node_modules/coveralls/bin/coveralls.js\n"),s("span",{attrs:{class:"token comment"}},[a._v("#env:")]),a._v("\n"),s("span",{attrs:{class:"token comment"}},[a._v("#  global:")]),a._v("\n"),s("span",{attrs:{class:"token comment"}},[a._v("#  - xxx: xxx")]),a._v("\n")])]),s("p",[a._v("以上格式就是指该项目，持续集成的分支是master，环境是node_js， 版本是4.2.2和6.0.0。项目默认会安装package.json中的依赖，之后会执行make test-all命令。")]),s("h2",{attrs:{id:"使用overalls进行覆盖率测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用overalls进行覆盖率测试","aria-hidden":"true"}},[a._v("#")]),a._v(" 使用Overalls进行覆盖率测试")]),s("p",[a._v("覆盖率测试的主要原理是，通过istanbul收集到mocha的cover信息，然后通过coveralls的工具，结合token传到平台上。")]),s("ul",[s("li",[s("p",[a._v("1.通过github登录Overalls官网，"),s("a",{attrs:{href:"https://coveralls.io",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网地址")])])]),s("li",[s("p",[a._v("2.添加Repo。")])])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/8-pic_hd-1467776646416.jpg",alt:"pic"}})]),s("ul",[s("li",[a._v("3.添加.coveralls.yml文件，配合Travis CI账号是用，一般.coveralls.yml配置如下：")])]),s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{attrs:{class:"token key atrule"}},[a._v("service_name")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" travis"),s("span",{attrs:{class:"token punctuation"}},[a._v("-")]),a._v("pro\n"),s("span",{attrs:{class:"token key atrule"}},[a._v("repo_token")]),s("span",{attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" xxx\n")])]),s("ul",[s("li",[a._v("4.编写测试文件，nodejs用mocha的例子结果如下：")])]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/7-pic_hd-1467776934375.jpg",alt:"pic"}})]),s("h2",{attrs:{id:"为readme-md增加badge"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为readme-md增加badge","aria-hidden":"true"}},[a._v("#")]),a._v(" 为README.md增加badge")]),s("p",[a._v("Travis CI和Overalls配置好后，会在项目每次push的时候进行测试，测试结果可以用badge的形式在README中体现。")]),s("p",[a._v("makedown格式的badge如下：")]),s("pre",{pre:!0,attrs:{class:"language-markdown"}},[s("code",[s("span",{attrs:{class:"token url"}},[a._v("[![Build Status](https://api.travis-ci.org/excaliburhan/api-koa.svg?branch=master)")]),a._v("](https://api.travis-ci.org/excaliburhan/api-koa)\n"),s("span",{attrs:{class:"token url"}},[a._v("[![Coverage Status](https://coveralls.io/repos/github/excaliburhan/api-koa/badge.svg?branch=master)")]),a._v("](https://coveralls.io/github/excaliburhan/api-koa?branch=master)\n")])]),s("p",[a._v("最后的效果如下：\n"),s("a",{attrs:{href:"https://api.travis-ci.org/excaliburhan/api-koa",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://api.travis-ci.org/excaliburhan/api-koa.svg?branch=master",alt:"Build Status"}})]),s("a",{attrs:{href:"https://coveralls.io/github/excaliburhan/api-koa?branch=master",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://coveralls.io/repos/github/excaliburhan/api-koa/badge.svg?branch=master",alt:"Coverage Status"}})])]),s("h2",{attrs:{id:"自定义badge"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义badge","aria-hidden":"true"}},[a._v("#")]),a._v(" 自定义badge")]),s("p",[a._v("这里推荐一下"),s("a",{attrs:{href:"http://shields.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("shields.io")]),a._v("，可以自定义badge，自定义格式如下：")]),s("p",[s("img",{attrs:{src:"https://o2znrmehg.qnssl.com/ghost/2016/07/06/9-pic-1467777324314.jpg",alt:"pic"}})])])}],!1,null,null,null);t.default=e.exports}}]);